<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>人生复盘测评</title>
  <style>
  body {
    font-family: "HarmonyOS Sans", "Helvetica Neue", sans-serif;
    background: linear-gradient(135deg, #f0f6ff, #eaf3fb);
    margin: 0;
    padding: 2rem;
    color: #333;
  }

  h1 {
    font-size: 2rem;
    text-align: center;
    margin-bottom: 2rem;
    color: #007aff;
  }

  .question {
    background: white;
    border-radius: 16px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
    padding: 2rem;
    max-width: 600px;
    margin: 0 auto 2rem auto;
    transition: all 0.3s ease;
  }

  .question h2 {
    font-size: 1.2rem;
    color: #333;
  }

  .options button {
    display: block;
    margin: 1rem 0;
    padding: 1rem;
    font-size: 1rem;
    background: #ffffff;
    border: 1px solid #ccc;
    border-radius: 8px;
    cursor: pointer;
    width: 100%;
    max-width: 100%;
    transition: all 0.2s ease;
  }

  .options button:hover {
    background-color: #f0f8ff;
    border-color: #007aff;
    color: #007aff;
  }

  .options button:active {
    transform: scale(0.98);
    background-color: #e0f0ff;
  }

  .hidden {
    display: none;
  }

  #result {
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    padding: 2rem;
    max-width: 700px;
    margin: 0 auto;
    text-align: center;
  }

  #result img {
    max-width: 100%;
    border-radius: 12px;
    margin: 1rem 0;
  }

  #restart {
    margin-top: 2rem;
    padding: 0.8rem 1.5rem;
    border: none;
    background: #007aff;
    color: white;
    font-weight: bold;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s ease;
  }

  #restart:hover {
    background: #005fcc;
  }
</style>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

</head>
<body>

  <div style="text-align: center;">
    <img src="logo.png" alt="人生复盘 LOGO" style="height: 50px; margin-bottom: 0.5rem;" />
    <h1 style="font-size: 2rem; font-weight: bold; color: #007aff;">人生复盘测评</h1>
  </div>
  <div id="progress" style="text-align:center; margin: 1rem 0; font-size: 1rem; color: #555;"></div>

  <div id="quiz"></div>
  <div id="result" class="hidden"></div>

  <script>

   const questions = [
  {
    text: "面对突发事件时你通常会？",
    options: [
      { text: "立即行动", tag: "冲动型" },
      { text: "拖到不能再拖", tag: "拖延型" },
      { text: "焦虑再勉强处理", tag: "内耗型" },
      { text: "完全不处理", tag: "反复型" }
    ]
  },
  {
    text: "分手/失业后的第一反应？",
    options: [
      { text: "立刻找下一条路", tag: "成长型" },
      { text: "情绪低落+责备自己", tag: "内耗型" },
      { text: "不处理当作没发生", tag: "冲动型" },
      { text: "翻旧账/回头再犯", tag: "反复型" }
    ]
  },
  {
    text: "购物决策时，你更可能？",
    options: [
      { text: "秒买事后后悔", tag: "冲动型" },
      { text: "研究半天买不下手", tag: "拖延型" },
      { text: "想太多选不出", tag: "内耗型" },
      { text: "被朋友一句话影响", tag: "反复型" }
    ]
  },
  {
    text: "你做过最常复盘的事情是？",
    options: [
      { text: "财务支出", tag: "成长型" },
      { text: "感情关系", tag: "成长型" },
      { text: "职业选择", tag: "成长型" },
      { text: "几乎没复盘过", tag: "反复型" }
    ]
  },
  {
    text: "你最常困住自己的行为是？",
    options: [
      { text: "冲动", tag: "冲动型" },
      { text: "拖延", tag: "拖延型" },
      { text: "内耗", tag: "内耗型" },
      { text: "重复", tag: "反复型" }
    ]
  },
  {
    text: "过去一年是否主动总结过错误？",
    options: [
      { text: "从未", tag: "反复型" },
      { text: "有意识但没形成习惯", tag: "内耗型" },
      { text: "有过2次左右", tag: "成长型" },
      { text: "每月都有", tag: "成长型" }
    ]
  },
  {
    text: "你倾向如何看待复盘？",
    options: [
      { text: "觉得麻烦", tag: "冲动型" },
      { text: "害怕面对错误", tag: "内耗型" },
      { text: "想做但不会写", tag: "拖延型" },
      { text: "是成长过程", tag: "成长型" }
    ]
  },
  {
    text: "你是哪类「卡住人生」的人？",
    options: [
      { text: "情绪困住我", tag: "内耗型" },
      { text: "行为失控我", tag: "冲动型" },
      { text: "总掉进同样陷阱", tag: "反复型" },
      { text: "不能开始坚持", tag: "拖延型" }
    ]
  },
  {
    text: "是否记录过任何复盘？",
    options: [
      { text: "写在日记本/备忘录", tag: "成长型" },
      { text: "用 Notion / App", tag: "成长型" },
      { text: "从未尝试过", tag: "反复型" }
    ]
  },
  {
    text: "如果有 App 引导复盘你会？",
    options: [
      { text: "愿意尝试", tag: "成长型" },
      { text: "不感兴趣", tag: "反复型" },
      { text: "觉得有用但不会主动用", tag: "内耗型" }
    ]
  },
  {
    text: "哪类功能你最想使用？",
    options: [
      { text: "每月总结提醒", tag: "成长型" },
      { text: "自动生成建议", tag: "成长型" },
      { text: "模板化引导", tag: "拖延型" },
      { text: "都不感兴趣", tag: "反复型" }
    ]
  },
  {
    text: "你最关心复盘的内容是？",
    options: [
      { text: "职业/金钱", tag: "成长型" },
      { text: "关系/情绪", tag: "内耗型" },
      { text: "习惯/自控力", tag: "拖延型" },
      { text: "其他", tag: "反复型" }
    ]
  },
  {
    text: "你偏好什么记录方式？",
    options: [
      { text: "自由书写", tag: "成长型" },
      { text: "选择+短答", tag: "拖延型" },
      { text: "AI引导", tag: "成长型" },
      { text: "语音转文字", tag: "冲动型" }
    ]
  },
  {
    text: "你写完一段反思后，希望得到什么回馈？",
    options: [
      { text: "有人总结重点", tag: "成长型" },
      { text: "看看也行", tag: "内耗型" },
      { text: "不需要反馈", tag: "反复型" },
      { text: "不想被解读", tag: "内耗型" }
    ]
  },
  {
    text: "若系统整理成报告，你偏好哪种呈现？",
    options: [
      { text: "图卡（关键词+趋势）", tag: "成长型" },
      { text: "人群案例", tag: "成长型" },
      { text: "问答引导", tag: "拖延型" },
      { text: "我自己整理", tag: "反复型" }
    ]
  },
  {
    text: "多久愿意回顾一次状态？",
    options: [
      { text: "每月一次最好提醒", tag: "成长型" },
      { text: "有事件发生后", tag: "冲动型" },
      { text: "想起来就看", tag: "反复型" },
      { text: "不喜欢回顾", tag: "反复型" }
    ]
  },
  {
    text: "你如何整理自己的思维？",
    options: [
      { text: "靠直觉想", tag: "冲动型" },
      { text: "偶尔写日记", tag: "成长型" },
      { text: "靠结构工具", tag: "成长型" },
      { text: "不整理", tag: "反复型" }
    ]
  },
  {
    text: "面对重复问题时希望哪种方式帮助？",
    options: [
      { text: "被问关键问题", tag: "成长型" },
      { text: "看过往记录", tag: "成长型" },
      { text: "看别人案例", tag: "成长型" },
      { text: "自己来", tag: "反复型" }
    ]
  }
];


    const scores = { "冲动型": 0, "拖延型": 0, "内耗型": 0, "反复型": 0, "成长型": 0 };
    let current = 0;

    const quiz = document.getElementById("quiz");
    const result = document.getElementById("result");

    const imageMap = {
      "冲动型": "replay-test-game/img/impulsive.png",
      "拖延型": "replay-test-game/img/delayer.png",
      "内耗型": "replay-test-game/img/internal.png",
      "反复型": "replay-test-game/img/repeat.png",
      "成长型": "replay-test-game/img/growth.png"
    };

    const descriptions = {
      "冲动型": {
        title: "你是【冲动型】：决策快，但常后悔",
        desc: "你倾向于快速做决定，但事后常感到后悔。你做事讲究效率，但有时缺乏深思熟虑。你的优势在于果断，缺点在于容易受情绪驱动而忽略后果。",
        suggestion: "建议你在做重要决策前，设定10分钟冷静思考时间，列出可能后果，避免冲动带来的损失。"
      },
      "拖延型": {
        title: "你是【拖延型】：思考多，行动慢",
        desc: "你常常明知道要做某件事，却习惯性地一拖再拖。你可能对任务的完美要求过高，从而导致无法及时开始。",
        suggestion: "建议采用“番茄工作法”，将任务分块，每次25分钟专注执行，逐步建立行动力。"
      },
      "内耗型": {
        title: "你是【内耗型】：高敏感，低效率",
        desc: "你在做决定前容易陷入反复纠结，并在决定后反复质疑自己。你思考深入但常被情绪内耗困住。",
        suggestion: "建议你练习记录情绪触发点，并设定每天一次的正面自我肯定练习，减轻内在批判。"
      },
      "反复型": {
        title: "你是【反复型】：明知问题，却反复踩坑",
        desc: "你会在不同阶段重复类似的错误，虽然意识到问题所在，但很难从根源上改变行为习惯。",
        suggestion: "建议你制作‘错误复盘表’，记录每次失误的原因及应对策略，提升觉察与行动一致性。"
      },
      "成长型": {
        title: "你是【成长型】：反思者，精进者",
        desc: "你善于反思，也愿意在试错中不断优化自己。你能从错误中总结经验，调整方向，持续进步。",
        suggestion: "建议你保持每月一次的复盘写作，记录成长点与失败点，系统梳理成长轨迹。"
      }
    };
    
    function renderQuestion() {
  const q = questions[current];
  const quiz = document.getElementById("quiz");

  quiz.innerHTML = `
    <div class="question">
      <h2>${q.text}</h2>
      <div class="options"></div>
    </div>
  `;

  const optionsDiv = quiz.querySelector(".options");

  q.options.forEach(opt => {
    const btn = document.createElement("button");
    btn.textContent = opt.text;

    btn.onclick = () => {
      // ✅ 记录类型得分（用于最终结果分类）
      scores[opt.tag] = (scores[opt.tag] || 0) + 1;

      // ✅ 记录本题用户选择的文本（用于 Google Sheet 上传）
      userAnswers.push(opt.text);

      current++;
      if (current < questions.length) {
        renderQuestion();
      } else {
        showResult(); // 测试结束
      }
    };

    optionsDiv.appendChild(btn);
  });

  // ✅ 可选：显示进度
  const progress = document.getElementById("progress");
  if (progress) {
    progress.innerText = `第 ${current + 1} / ${questions.length} 题`;
  }
}


  function showResult() {
      quiz.classList.add("hidden");
      const maxTag = Object.entries(scores).sort((a, b) => b[1] - a[1])[0][0];
      const data = descriptions[maxTag];
      result.classList.remove("hidden");
      result.innerHTML = `
  <div id="resultCard" style="background: white; padding: 2rem; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
    <h2 style="font-size: 1.5rem; color: #007aff; margin-bottom: 1rem;">${data.title}</h2>
  <img src="${imageMap[maxTag]}" alt="${maxTag} 结果图" style="max-width: 100%; border-radius: 12px; margin-bottom: 1rem;" />
    <p style="font-size: 1.1rem; color: #333; line-height: 1.6;">${data.desc}</p>
  <div style="background: #f5faff; padding: 1.2rem; border-radius: 12px; margin-top: 2rem;">
      <h3 style="font-size: 1.2rem; color: #007aff; margin-bottom: 0.5rem;">🌱 行动建议</h3>
      <p style="font-size: 1rem; color: #444; line-height: 1.6;">${data.suggestion}</p>
    </div>
  <button id='restart' style="margin-top: 2rem;">再测一次</button>
 <button onclick="downloadResult()" style="margin-left:1rem; background:#00c28b;">保存为图片</button>
  </div>
  <div id="shareBlock" style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #ddd;">
    <p style="font-weight:bold;">📣 分享给朋友：</p>
    <button onclick="copyLink()" style="padding: 0.5rem 1rem; margin: 0.3rem;">复制测试链接</button>
    <button onclick="showQR()" style="padding: 0.5rem 1rem; margin: 0.3rem;">显示微信二维码</button>
    <button onclick="showText()" style="padding: 0.5rem 1rem; margin: 0.3rem;">获取朋友圈文案</button>

    <div id="qr" style="margin-top: 1rem; display:none;">
      <img src="your-wechat-qr.png" alt="微信二维码" style="width: 150px;">
      <p style="font-size:0.85rem; color:#777;">长按识别二维码</p>
    </div>

    <div id="shareText" style="margin-top: 1rem; display:none; background: #f8f9fb; padding: 1rem; border-radius: 8px; font-size: 0.9rem; color: #333;">
      🌟测了一个超准的人生复盘系统<br>
      我是【${maxTag}】，看看你是哪一类？<br>
      🔗 ${location.href}
    </div>
  </div>
`;
      document.getElementById("restart").onclick = () => location.reload();
   uploadAnswersToSheet();
}
function uploadAnswersToSheet() {
  const trackedQuestions = [
    { field: "fav_review_topic", index: 3 },
    { field: "review_frequency", index: 5 },
    { field: "review_habit", index: 8 },
    { field: "app_acceptance", index: 9 },
    { field: "preferred_features", index: 10 },
    { field: "focus_area", index: 11 },
    { field: "input_preference", index: 12 },
    { field: "feedback_desire", index: 13 },
    { field: "report_format_preference", index: 14 },
    { field: "review_interval", index: 15 },
    { field: "thinking_style", index: 16 },
    { field: "support_expectation", index: 17 }
  ];

  const answers = {};

  trackedQuestions.forEach(({ field, index }) => {
    answers[field] = userAnswers[index] || "未答";
  });

  // 添加时间戳
  answers.timestamp = new Date().toISOString();

  fetch("https://api.sheety.co/7b136ddd068b2f5ee3c7063a6a760256/test/sheet1", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ sheet1: answers })
  })
    .then(res => res.json())
    .then(data => {
      console.log("✅ 数据上传成功：", data);
    })
    .catch(err => {
      console.error("❌ 数据上传失败：", err);
    });
}



  
function copyLink() {
  navigator.clipboard.writeText('https://life-test-replay.vercel.app/').then(() => {
    alert("✅ 链接已复制，快去发朋友圈或微信吧！");
  });
}

function showQR() {
  document.getElementById("qr").style.display = "block";
}

function showText() {
  document.getElementById("shareText").style.display = "block";
}

    renderQuestion();
  </script>

</body>
</html>



